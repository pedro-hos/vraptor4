<!DOCTYPE HTML> <html lang="pt"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width"> <title>VRaptor 4 - Eventos</title> <link rel="shortcut icon" href="../../../img/favicon.png"> <link rel="stylesheet" href="/css/style.min.css"/> <meta name="generator" content="nanoc 3.6.7"> </head> <body> <header class="container"> <h1 class="logo"><a class="logo-link" href="../.."> <img src="../../../img/logo.png" alt="VRaptor"> </a></h1> <ul class="community"> <li><a href="https://groups.google.com/forum/#!forum/caelum-vraptor" target="_blank">Google Groups</a></li> <li><a href="https://github.com/caelum/vraptor4/" target="_blank">GitHub</a></li> <li><a href="http://www.guj.com.br/tag/vraptor" target="_blank">GUJ Respostas</a></li> </ul> <ul class="site-languages"> <li> <a class="site-language flag flag-en not-selected" title="en" href="../../../en"> EN </a> </li> <li> <a class="site-language flag flag-pt " title="pt" href="../.."> PT </a> </li> </ul> </header> <input type="checkbox" id="nav-visibility"> <label for="nav-visibility" class="nav-toggle">Menu</label> <nav class="main-nav"> <ul> <li><a href="../../download">Download</a></li> <li><a href="../guia-de-1-minuto/">Documentação</a></li> <li><a href="../../cookbook/aceitando-urls-com-ou-sem-barra-no-final">Cookbook</a></li> <li><a href="https://github.com/caelum/vraptor4/releases" target="_blank">Changelog</a></li> <li><a href="https://github.com/caelum/vraptor4/milestones" target="_blank">Roadmap</a></li> <li><a href="../../../javadoc">Javadoc</a></li> </ul> </nav> <nav class="doc-nav container"> <h1>Documentação</h1> <ul> <li><a href="../guia-de-1-minuto">Guia inicial de 1 minuto</a></li> <li><a href="../guia-de-10-minutos">Guia inicial de 10 minutos</a></li> <li><a href="../controllers-rest">Controllers Rest</a></li> <li><a href="../componentes">Componentes</a></li> <li><a href="../conversores">Conversores</a></li> <li><a href="../validacao">Validação</a></li> <li><a href="../interceptadores">Interceptadores</a></li> <li><a href=".">Eventos</a></li> <li><a href="../trabalhando-com-a-view">Trabalhando com a View</a></li> <li><a href="../download-e-upload">Download e Upload</a></li> <li><a href="../environment">Environment</a></li> <li><a href="../plugins">Plugins</a></li> <li><a href="../dependencias-e-pre-requisitos">Dependências e pré requisitos</a></li> <li><a href="../testando-componentes-e-controllers">Testando Componentes e Controllers</a></li> <li><a href="../migrando-de-um-projeto-com-vraptor3">Migrando de um projeto com VRaptor 3</a></li> <li><a href="../contribuindo-com-o-vraptor">Contribuindo com o VRaptor</a></li> </ul> </nav> <main class="container doc-container"> <h1 id="trabalhando-com-o-recurso-de-eventos-do-cdi">Trabalhando com o recurso de Eventos do CDI</h1> <p>O VRaptor agora trata o fluxo principal do request utilizando eventos do CDI. A seguinte imagem exibe os eventos disparados e seus respectivos observers:</p> <p><img src="../../../img/vraptorEventPipeline.png" id="eventPileline" alt="VRaptor 4 Event Pipeline"></p> <h2 id="eventos-disparados-pelo-vraptor">Eventos disparados pelo VRaptor</h2> <ul> <li> <code>VRaptorInitialized</code> disparado no startup da aplicação, indicando que o VRaptor foi inicializado.</li> <li> <code>RequestStarted</code> disparado no início de cada request.</li> <li> <code>RequestSucceeded</code> disparado no final do request, apenas caso ela tenha sido processada sem nenhum erro.</li> <li> <code>ControllerFound</code> e <code>ControllerNotFound</code> vão indicar se o Controller que atende a url do request foi encontrado ou não.</li> <li> <code>InterceptorsReady</code> e <code>InterceptorsExecuted</code> indicam o momento em que a stack de interceptors será executada e logo após sua conclusão.</li> <li> <code>MethodReady</code> e <code>MethodExecuted</code> quando o método do controller será executado e logo após sua conclusão.</li> </ul> <h2 id="observando-nossos-eventos">Observando nossos eventos</h2> <p>Você pode observar qualquer evento disparado pelo VRaptor, para isso basta criar um método com a anotação <code>@Observes</code> do pacote <code>javax.enterprise.event</code> antes do evento como parâmetro. Algo como:</p> <pre><code class="language-java"><span class="kn">import</span> <span class="nn">javax.enterprise.event.Observes</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">br.com.caelum.vraptor.events.ControllerNotFound</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MeuObserver</span> <span class="o">{</span>
    
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">metodo</span><span class="o">(</span><span class="nd">@Observes</span> <span class="n">ControllerNotFound</span> <span class="n">evento</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">// alguma ação para quando o controller não for encontrado</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre> <p>É importante lembrar que não existe ordem na execução dos observers, ou seja, não há garantia que o meu método será executado antes ou depois de qualquer outro método que observe este mesmo evento. Caso a ordem seja importante, considere utilizar interceptors.</p> <h2 id="mais-sobre-eventos">Mais sobre eventos</h2> <p>Esse interessante recurso te ajuda a diminuir o acoplamento de seu código de forma elegante. Você pode ler mais a respeito dos eventos do CDI <a href="http://docs.jboss.org/cdi/spec/1.1/cdi-spec.html#_event_example">em sua especificação</a> e também <a href="http://blog.caelum.com.br/diminua-suas-dependencias-com-os-eventos-do-cdi/">nesse post do blog da caelum</a>.</p> </main> <script src="/js/headers.min.js"></script> </body> </html>