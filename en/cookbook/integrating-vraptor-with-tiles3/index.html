<!DOCTYPE HTML> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width"> <title>VRaptor 4 - Integrating VRaptor with Tiles 3</title> <link rel="shortcut icon" href="../../../img/favicon.png"> <link rel="stylesheet" href="/css/style.min.css"/> <meta name="generator" content="nanoc 3.6.7"> </head> <body> <header class="container"> <h1 class="logo"><a class="logo-link" href="../.."> <img src="../../../img/logo.png" alt="VRaptor"> </a></h1> <ul class="community"> <li><a href="https://groups.google.com/forum/?hl=en#!forum/vraptor4" target="_blank">Google Groups</a></li> <li><a href="https://github.com/caelum/vraptor4/" target="_blank">GitHub</a></li> <li><a href="http://questions.vraptor.org" target="_blank">VRaptor Questions</a></li> </ul> <ul class="site-languages"> <li> <a class="site-language flag flag-en " title="en" href="../.."> EN </a> </li> <li> <a class="site-language flag flag-pt not-selected" title="pt" href="../../../pt"> PT </a> </li> </ul> </header> <input type="checkbox" id="nav-visibility"> <label for="nav-visibility" class="nav-toggle">Menu</label> <nav class="main-nav"> <ul> <li><a href="../../download">Download</a></li> <li><a href="../../docs/one-minute-guide/">Documentation</a></li> <li><a href="../accepting-urls-ending-with-a-slash">Cookbook</a></li> <li><a href="https://github.com/caelum/vraptor4/releases" target="_blank">Changelog</a></li> <li><a href="https://github.com/caelum/vraptor4/milestones" target="_blank">Roadmap</a></li> <li><a href="../../../javadoc">Javadoc</a></li> </ul> </nav> <nav class="doc-nav container"> <h1>Cookbook</h1> <ul> <li> <a href="../accepting-urls-ending-with-a-slash"> Accepting URLs ending with a slash </a> </li> <li> <a href="../building-a-web-application-with-java8-vraptor4-wildfly"> Building a Web Application with Java 8 and VRaptor4 on Wildfly </a> </li> <li> <a href="../avoiding-browser-cache"> Avoiding browser cache </a> </li> <li> <a href="../using-the-referer-header-to-redirect"> Using Referer Header to redirect </a> </li> <li> <a href="."> Integrating VRaptor with Tiles 3 </a> </li> </ul> </nav> <main class="container"> <h1 id="by-otvio-garcia">by Otávio Garcia</h1> <p>Apache Tiles is a framework that implements the Composite View pattern, and makes possible to create templates for your application in easy way. You can found more information visiting <a href="http://tiles.apache.org">Tiles website</a>.</p> <p>The first step is include the Tiles dependency in your Maven project as described below. If you don’t uses Maven, you can download all files and its dependencies in <a href="http://tiles.apache.org">Tiles website</a>.</p> <pre><code class="language-xml"><span class="nt">&lt;dependency&gt;</span>
    <span class="nt">&lt;groupId&gt;</span>org.apache.tiles<span class="nt">&lt;/groupId&gt;</span>
    <span class="nt">&lt;artifactId&gt;</span>tiles-extras<span class="nt">&lt;/artifactId&gt;</span>
    <span class="nt">&lt;version&gt;</span>3.0.0<span class="nt">&lt;/version&gt;</span> <span class="c">&lt;!-- or the latest version --&gt;</span>
<span class="nt">&lt;/dependency&gt;</span></code></pre> <p>And the next step is to add the listener that tells to Tiles when your application is up and ready.</p> <pre><code class="language-xml"><span class="nt">&lt;listener&gt;</span>
    <span class="nt">&lt;listener-class&gt;</span>org.apache.tiles.extras.complete.CompleteAutoloadTilesListener<span class="nt">&lt;/listener-class&gt;</span>
<span class="nt">&lt;/listener&gt;</span></code></pre> <p>And for the last step, you need to declare the <code>Servlet</code> that will respond Tiles requests. In the example below, any request to the URL <code>*.tiles</code> will be forwarded to Tiles templates.</p> <pre><code class="language-xml"><span class="nt">&lt;servlet&gt;</span>
    <span class="nt">&lt;servlet-name&gt;</span>TilesDispatchServlet<span class="nt">&lt;/servlet-name&gt;</span>
    <span class="nt">&lt;servlet-class&gt;</span>org.apache.tiles.web.util.TilesDispatchServlet<span class="nt">&lt;/servlet-class&gt;</span>
<span class="nt">&lt;/servlet&gt;</span>
<span class="nt">&lt;servlet-mapping&gt;</span>
    <span class="nt">&lt;servlet-name&gt;</span>TilesDispatchServlet<span class="nt">&lt;/servlet-name&gt;</span>
    <span class="nt">&lt;url-pattern&gt;</span>*.tiles<span class="nt">&lt;/url-pattern&gt;</span>
<span class="nt">&lt;/servlet-mapping&gt;</span></code></pre> <p>And now we have Tiles listening requests.</p> <p>By default, VRaptor does forwards to JSPs. So we need to override this behavior to forward to Tiles templates. We can do it changing the class <code>DefaultPathResolver</code> as described below.</p> <pre><code class="language-java"><span class="nd">@Specializes</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">TilesPathResolver</span> <span class="kd">extends</span> <span class="n">DefaultPathResolver</span> <span class="o">{</span>

    <span class="nd">@Inject</span>
    <span class="kd">protected</span> <span class="nf">TilesPathResolver</span><span class="o">(</span><span class="n">FormatResolver</span> <span class="n">resolver</span><span class="o">)</span> <span class="o">{</span>
        <span class="kd">super</span><span class="o">(</span><span class="n">resolver</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">protected</span> <span class="n">String</span> <span class="nf">getPrefix</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="s">"/"</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">protected</span> <span class="n">String</span> <span class="nf">getExtension</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="s">"tiles"</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre> <p>With this code, whether the request was initiated for method <code>CustomerController.form</code>, VRaptor will forward to template <code>customer.form</code>. So we only need by now to create the template definition in the file <code>/WEB-INF/tiles.xml</code>:</p> <pre><code class="language-xml"><span class="nt">&lt;definition</span> <span class="na">name=</span><span class="s">"customer/form"</span> <span class="na">template=</span><span class="s">"/WEB-INF/jsp/layouts/basic.jsp"</span><span class="nt">&gt;</span>
    [...]
<span class="nt">&lt;/definition&gt;</span></code></pre> </main> <script src="/js/headers.min.js"></script> </body> </html>